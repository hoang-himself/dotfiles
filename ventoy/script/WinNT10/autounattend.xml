<?xml version="1.0" encoding="utf-8"?>
<unattend xmlns="urn:schemas-microsoft-com:unattend"
  xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <settings pass="windowsPE">
    <component name="Microsoft-Windows-Setup" processorArchitecture="amd64"
      publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
      <UserData>
        <AcceptEula>true</AcceptEula>
        <ProductKey>
          <Key></Key>
          <WillShowUI>Always</WillShowUI>
        </ProductKey>
      </UserData>
    </component>
  </settings>
  <settings pass="offlineServicing"></settings>
  <settings pass="generalize"></settings>
  <settings pass="specialize">
    <component name="Microsoft-Windows-Deployment" processorArchitecture="amd64"
      publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
      <RunSynchronous>
        <RunSynchronousCommand wcm:action="add">
          <Order>1</Order>
          <Path>cmd.exe /q /c "FOR %i IN (A B C D E F G H I J K L M N O P Q R S T U V W X Y Z) DO IF EXIST %i:\bootstrap\WinNT10\CreateSetup.cmd cmd.exe /q /c %i:\bootstrap\WinNT10\CreateSetup.cmd"</Path>
        </RunSynchronousCommand>
        <RunSynchronousCommand wcm:action="add">
          <Order>2</Order>
          <Path>powershell.exe -NoProfile -Command "$xml = [xml]::new(); $xml.Load('C:\Windows\Panther\unattend.xml'); $sb = [scriptblock]::Create($xml.unattend.Extensions.ExtractScript); Invoke-Command -ScriptBlock $sb -ArgumentList $xml;"</Path>
        </RunSynchronousCommand>
        <RunSynchronousCommand wcm:action="add">
          <Order>3</Order>
          <Path>powershell.exe -NoProfile -Command "Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\Specialize.ps1' -Raw | Invoke-Expression;"</Path>
        </RunSynchronousCommand>
        <RunSynchronousCommand wcm:action="add">
          <Order>4</Order>
          <Path>reg.exe load "HKU\DefaultUser" "C:\Users\Default\NTUSER.DAT"</Path>
        </RunSynchronousCommand>
        <RunSynchronousCommand wcm:action="add">
          <Order>5</Order>
          <Path>powershell.exe -NoProfile -Command "Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\DefaultUser.ps1' -Raw | Invoke-Expression;"</Path>
        </RunSynchronousCommand>
        <RunSynchronousCommand wcm:action="add">
          <Order>6</Order>
          <Path>reg.exe unload "HKU\DefaultUser"</Path>
        </RunSynchronousCommand>
      </RunSynchronous>
    </component>
  </settings>
  <settings pass="auditSystem"></settings>
  <settings pass="auditUser"></settings>
  <settings pass="oobeSystem">
    <component name="Microsoft-Windows-Shell-Setup" processorArchitecture="amd64"
      publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
      <OOBE>
        <HideEULAPage>true</HideEULAPage>
        <HideOnlineAccountScreens>true</HideOnlineAccountScreens>
        <ProtectYourPC>3</ProtectYourPC>
      </OOBE>
      <FirstLogonCommands>
        <SynchronousCommand wcm:action="add">
          <Order>1</Order>
          <CommandLine>powershell.exe -NoProfile -Command "Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\FirstLogon.ps1' -Raw | Invoke-Expression;"</CommandLine>
        </SynchronousCommand>
      </FirstLogonCommands>
    </component>
  </settings>
  <Extensions>
    <ExtractScript>
param(
  [xml]$Document
);

foreach($file in $Document.unattend.Extensions.File) {
  $path = [System.Environment]::ExpandEnvironmentVariables($file.GetAttribute('path'));
  mkdir -Path ($path | Split-Path -Parent) -ErrorAction 'SilentlyContinue';
  $content = $file.InnerText.Trim();
  if ($file.GetAttribute('transformation') -ieq 'Base64') {
    [System.IO.File]::WriteAllBytes($path, [System.Convert]::FromBase64String($content));
  } else {
    $encoding = switch([System.IO.Path]::GetExtension($path)) {
      { $_ -in '.ps1', '.xml' } { [System.Text.Encoding]::UTF8; }
      { $_ -in '.reg', '.vbs', '.js' } { [System.Text.UnicodeEncoding]::new($false, $true); }
      default { [System.Text.Encoding]::Default; }
    };
    [System.IO.File]::WriteAllBytes($path, ($encoding.GetPreamble() + $encoding.GetBytes($content)));
  }
}
    </ExtractScript>
    <File path="C:\Windows\Setup\Scripts\RemovePackages.ps1" transformation="Text">
$selectors = @(
  'Microsoft.Microsoft3DViewer';
  'Microsoft.BingSearch';
  #'Microsoft.WindowsCalculator';
  #'Microsoft.WindowsCamera';
  'Clipchamp.Clipchamp';
  #'Microsoft.WindowsAlarms';
  'Microsoft.549981C3F5F10';
  'Microsoft.Windows.DevHome';
  'MicrosoftCorporationII.MicrosoftFamily';
  'Microsoft.WindowsFeedbackHub';
  'Microsoft.GetHelp';
  'Microsoft.Getstarted';
  'microsoft.windowscommunicationsapps';
  #'Microsoft.WindowsMaps';
  'Microsoft.MixedReality.Portal';
  'Microsoft.BingNews';
  #'Microsoft.WindowsNotepad';
  'Microsoft.MicrosoftOfficeHub';
  'Microsoft.Office.OneNote';
  'Microsoft.OutlookForWindows';
  'Microsoft.Paint';
  'Microsoft.MSPaint';
  'Microsoft.People';
  'Microsoft.Windows.Photos';
  'Microsoft.PowerAutomateDesktop';
  'MicrosoftCorporationII.QuickAssist';
  'Microsoft.SkypeApp';
  'Microsoft.ScreenSketch';
  'Microsoft.MicrosoftSolitaireCollection';
  #'Microsoft.MicrosoftStickyNotes';
  'MicrosoftTeams';
  'MSTeams';
  #'Microsoft.Todos';
  #'Microsoft.WindowsSoundRecorder';
  'Microsoft.Wallet';
  'Microsoft.BingWeather';
  #'Microsoft.WindowsTerminal';
  'Microsoft.Xbox.TCUI';
  'Microsoft.XboxApp';
  'Microsoft.XboxGameOverlay';
  'Microsoft.XboxGamingOverlay';
  'Microsoft.XboxIdentityProvider';
  'Microsoft.XboxSpeechToTextOverlay';
  'Microsoft.GamingApp';
  'Microsoft.YourPhone';
  'Microsoft.ZuneMusic';
  'Microsoft.ZuneVideo';
);

$getCommand = { Get-AppxProvisionedPackage -Online; }
$filterCommand = { $_.DisplayName -eq $selector; }
$removeCommand = {
  [CmdletBinding()]
  param(
    [Parameter(Mandatory, ValueFromPipeline)]$InputObject
  );
  process {
    $InputObject `
    | Remove-AppxProvisionedPackage -AllUsers -Online -ErrorAction 'Continue';
  }
}

$type = 'Package';
$logfile = 'C:\Windows\Setup\Scripts\RemovePackages.log';

&amp; {
  $installed = &amp; $getCommand;
  foreach ($selector in $selectors) {
    $result = [ordered]@{ Selector = $selector; }
    $found = $installed | Where-Object -FilterScript $filterCommand;
    if ($found) {
      $result.Output = $found | &amp; $removeCommand;
      if ($?) {
        $result.Message = "$type removed.";
      } else {
        $result.Message = "$type not removed.";
        $result.Error = $Error[0];
      }
    } else {
      $result.Message = "$type not installed.";
    }
    $result | ConvertTo-Json -Depth 3 -Compress;
  }
} *&gt;&amp;1 &gt;&gt; $logfile;
    </File>
    <File path="C:\Windows\Setup\Scripts\RemoveCapabilities.ps1" transformation="Text">
$selectors = @(
  'Print.Fax.Scan';
  'Language.Handwriting';
  'Browser.InternetExplorer';
  'MathRecognizer';
  #'Microsoft.Windows.Notepad';
  #'Microsoft.Windows.Notepad.System';
  'OneCoreUAP.OneSync';
  'OpenSSH.Client';
  'Microsoft.Windows.MSPaint';
  'Microsoft.Windows.PowerShell.ISE';
  'App.Support.QuickAssist';
  'Microsoft.Windows.SnippingTool';
  'Language.Speech';
  'Language.TextToSpeech';
  'App.StepsRecorder';
  'Hello.Face.18967';
  'Hello.Face.Migration.18967';
  'Hello.Face.20134';
  'Media.WindowsMediaPlayer';
  'Microsoft.Windows.WordPad';
);

$getCommand = {
  Get-WindowsCapability -Online `
  | Where-Object -Property 'State' -NotIn -Value @(
    'NotPresent';
    'Removed';
  );
};
$filterCommand = { ($_.Name -split '~')[0] -eq $selector; };
$removeCommand = {
  [CmdletBinding()]
  param(
    [Parameter(Mandatory, ValueFromPipeline)]$InputObject
  );
  process {
    $InputObject `
    | Remove-WindowsCapability -Online -ErrorAction 'Continue';
  }
};

$type = 'Capability';
$logfile = 'C:\Windows\Setup\Scripts\RemoveCapabilities.log';

&amp; {
  $installed = &amp; $getCommand;
  foreach ($selector in $selectors) {
    $result = [ordered]@{ Selector = $selector; };
    $found = $installed | Where-Object -FilterScript $filterCommand;
    if ($found) {
      $result.Output = $found | &amp; $removeCommand;
      if ($?) {
        $result.Message = "$type removed.";
      } else {
        $result.Message = "$type not removed.";
        $result.Error = $Error[0];
      }
    } else {
      $result.Message = "$type not installed.";
    }
    $result | ConvertTo-Json -Depth 3 -Compress;
  }
} *&gt;&amp;1 &gt;&gt; $logfile;
    </File>
    <File path="C:\Windows\Setup\Scripts\RemoveFeatures.ps1" transformation="Text">
$selectors = @(
  'MediaPlayback';
  'MicrosoftWindowsPowerShellV2Root';
  'Microsoft-RemoteDesktopConnection';
  'Recall';
  'Microsoft-SnippingTool';
);

$getCommand = {
  Get-WindowsOptionalFeature -Online `
  | Where-Object -Property 'State' -NotIn -Value @(
    'Disabled';
    'DisabledWithPayloadRemoved';
  );
};
$filterCommand = { $_.FeatureName -eq $selector; };
$removeCommand = {
  [CmdletBinding()]
  param(
    [Parameter(Mandatory, ValueFromPipeline)]$InputObject
  );
  process {
    $InputObject `
    | Disable-WindowsOptionalFeature -Online -Remove -NoRestart -ErrorAction 'Continue';
  }
};

$type = 'Feature';
$logfile = 'C:\Windows\Setup\Scripts\RemoveFeatures.log';

&amp; {
  $installed = &amp; $getCommand;
  foreach ($selector in $selectors) {
    $result = [ordered]@{ Selector = $selector; };
    $found = $installed | Where-Object -FilterScript $filterCommand;
    if ($found) {
      $result.Output = $found | &amp; $removeCommand;
      if ($?) {
        $result.Message = "$type removed.";
      } else {
        $result.Message = "$type not removed.";
        $result.Error = $Error[0];
      }
    } else {
      $result.Message = "$type not installed.";
    }
    $result | ConvertTo-Json -Depth 3 -Compress;
  }
} *&gt;&amp;1 &gt;&gt; $logfile;
    </File>
    <File path="C:\Windows\Setup\Scripts\SetStartPins.ps1" transformation="Text">
$json = '{"pinnedList":[]}';
if ([System.Environment]::OSVersion.Version.Build -lt 20000) { return; }
$key = 'Registry::HKLM\SOFTWARE\Microsoft\PolicyManager\current\device\Start';
New-Item -ItemType 'Directory' -Path $key -ErrorAction 'SilentlyContinue';
Set-ItemProperty -LiteralPath $key -Name 'ConfigureStartPins' -Type 'String' -Value $json;
    </File>
    <File path="C:\Windows\Setup\Scripts\TakeOwnership.reg">
Windows Registry Editor Version 5.00

; Adds "Take Ownership" to the Right Click Context Menu

[-HKEY_CLASSES_ROOT\*\shell\TakeOwnership]
[-HKEY_CLASSES_ROOT\*\shell\runas]

[HKEY_CLASSES_ROOT\*\shell\TakeOwnership]
@="Take Ownership"
"Extended"=-
"HasLUAShield"=""
"NoWorkingDirectory"=""
"NeverDefault"=""

[HKEY_CLASSES_ROOT\*\shell\TakeOwnership\command]
@="powershell -windowstyle hidden -command \"Start-Process cmd -ArgumentList '/c takeown /f \\\"%1\\\" &amp;&amp; icacls \\\"%1\\\" /grant *S-1-3-4:F /t /c /l &amp; pause' -Verb runAs\""
"IsolatedCommand"= "powershell -windowstyle hidden -command \"Start-Process cmd -ArgumentList '/c takeown /f \\\"%1\\\" &amp;&amp; icacls \\\"%1\\\" /grant *S-1-3-4:F /t /c /l &amp; pause' -Verb runAs\""

[HKEY_CLASSES_ROOT\Directory\shell\TakeOwnership]
@="Take Ownership"
"AppliesTo"="NOT (System.ItemPathDisplay:=\"C:\\Users\" OR System.ItemPathDisplay:=\"C:\\ProgramData\" OR System.ItemPathDisplay:=\"C:\\Windows\" OR System.ItemPathDisplay:=\"C:\\Windows\\System32\" OR System.ItemPathDisplay:=\"C:\\Program Files\" OR System.ItemPathDisplay:=\"C:\\Program Files (x86)\")"
"Extended"=-
"HasLUAShield"=""
"NoWorkingDirectory"=""
"Position"="middle"

[HKEY_CLASSES_ROOT\Directory\shell\TakeOwnership\command]
@="powershell -windowstyle hidden -command \"$Y = ($null | choice).Substring(1,1); Start-Process cmd -ArgumentList ('/c takeown /f \\\"%1\\\" /r /d ' + $Y + ' &amp;&amp; icacls \\\"%1\\\" /grant *S-1-3-4:F /t /c /l /q &amp; pause') -Verb runAs\""
"IsolatedCommand"="powershell -windowstyle hidden -command \"$Y = ($null | choice).Substring(1,1); Start-Process cmd -ArgumentList ('/c takeown /f \\\"%1\\\" /r /d ' + $Y + ' &amp;&amp; icacls \\\"%1\\\" /grant *S-1-3-4:F /t /c /l /q &amp; pause') -Verb runAs\""

[HKEY_CLASSES_ROOT\Drive\shell\runas]
@="Take Ownership"
"Extended"=-
"HasLUAShield"=""
"NoWorkingDirectory"=""
"Position"="middle"
"AppliesTo"="NOT (System.ItemPathDisplay:=\"C:\\\")"

[HKEY_CLASSES_ROOT\Drive\shell\runas\command]
@="cmd.exe /c takeown /f \"%1\\\" /r /d y &amp;&amp; icacls \"%1\\\" /grant *S-1-3-4:F /t /c &amp; Pause"
"IsolatedCommand"="cmd.exe /c takeown /f \"%1\\\" /r /d y &amp;&amp; icacls \"%1\\\" /grant *S-1-3-4:F /t /c &amp; Pause"
    </File>
    <File path="C:\Windows\Setup\Scripts\WinTweaks.ps1">
# Groups or splits svchost.exe processes based on the amount of physical memory in the system to optimize performance
$ram = (Get-CimInstance -ClassName Win32_PhysicalMemory | Measure-Object -Property Capacity -Sum).Sum / 1kb;
Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control' -Name 'SvcHostSplitThresholdInKB' -Type DWord -Value $ram -Force;

$autoLoggerDir = "$env:PROGRAMDATA\Microsoft\Diagnosis\ETLLogs\AutoLogger"
if (Test-Path "$autoLoggerDir\AutoLogger-Diagtrack-Listener.etl") {
  Remove-Item "$autoLoggerDir\AutoLogger-Diagtrack-Listener.etl";
}
$icaclsCommand = "icacls `"$autoLoggerDir`" /deny SYSTEM:`"(OI)(CI)F`"";
Invoke-Expression $icaclsCommand | Out-Null;

# Disable Defender Auto Sample Submission
Set-MpPreference -SubmitSamplesConsent 2 -ErrorAction Continue | Out-Null;

# Removes Microsoft Teams
$TeamsPath = [System.IO.Path]::Combine($env:LOCALAPPDATA, 'Microsoft', 'Teams');
$TeamsUpdateExePath = [System.IO.Path]::Combine($TeamsPath, 'Update.exe');

Stop-Process -Name '*teams*' -Force -ErrorAction Continue;

if ([System.IO.File]::Exists($TeamsUpdateExePath)) {
  $proc = Start-Process $TeamsUpdateExePath '-uninstall -s' -PassThru;
  $proc.WaitForExit();
}

Get-AppxPackage '*Teams*' | Remove-AppxPackage -ErrorAction Continue;
Get-AppxPackage '*Teams*' -AllUsers | Remove-AppxPackage -AllUsers -ErrorAction Continue;

if ([System.IO.Directory]::Exists($TeamsPath)) {
  Remove-Item $TeamsPath -Force -Recurse -ErrorAction Continue;
}

# Uninstall from Uninstall registry key UninstallString
$us = (
  Get-ChildItem -Path HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall, HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall `
  | Get-ItemProperty `
  | Where-Object { $_.DisplayName -like '*Teams*' }
).UninstallString;
if ($us.Length -gt 0) {
  $us = ($us.Replace('/I', '/uninstall ') + ' /quiet').Replace('  ', ' ');
  $FilePath = ($us.Substring(0, $us.IndexOf('.exe') + 4).Trim());
  $ProcessArgs = ($us.Substring($us.IndexOf('.exe') + 5).Trim().replace('  ', ' '));
  $proc = Start-Process -FilePath $FilePath -Args $ProcessArgs -PassThru;
  $proc.WaitForExit();
}

# Disables Teredo
$registryKeysTeredo = @(
  @{Path = 'HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters'; Name = 'DisabledComponents'; Type = 'DWord'; Value = 1 }
)
foreach ($key in $registryKeysTeredo) {
  New-ItemProperty -Path $key.Path -Name $key.Name -PropertyType $key.Type -Value $key.Value -Force;
}
netsh interface teredo set state disabled;

# Disable Scheduled Tasks
$scheduledTasks = @(
  'Microsoft\Windows\Application Experience\Microsoft Compatibility Appraiser',
  'Microsoft\Windows\Application Experience\ProgramDataUpdater',
  'Microsoft\Windows\Autochk\Proxy',
  'Microsoft\Windows\Customer Experience Improvement Program\Consolidator',
  'Microsoft\Windows\Customer Experience Improvement Program\UsbCeip',
  'Microsoft\Windows\DiskDiagnostic\Microsoft-Windows-DiskDiagnosticDataCollector',
  'Microsoft\Windows\Feedback\Siuf\DmClient',
  'Microsoft\Windows\Feedback\Siuf\DmClientOnScenarioDownload',
  'Microsoft\Windows\Windows Error Reporting\QueueReporting',
  'Microsoft\Windows\Application Experience\MareBackup',
  'Microsoft\Windows\Application Experience\StartupAppTask',
  'Microsoft\Windows\Application Experience\PcaPatchDbTask',
  'Microsoft\Windows\Maps\MapsUpdateTask'
);
foreach ($task in $scheduledTasks) {
  schtasks /Change /TN $task /Disable;
}

# Enable the Ultimate Performance power plan
powercfg -duplicatescheme e9a42b02-d5df-448d-aa00-03f14749eb61;

# Set Services to Manual
Set-Service -Name 'AJRouter' -StartupType Disabled -ErrorAction Continue;
Set-Service -Name 'ALG' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'AppIDSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'AppMgmt' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'AppReadiness' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'AppVClient' -StartupType Disabled -ErrorAction Continue;
Set-Service -Name 'AppXSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'Appinfo' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'AssignedAccessManagerSvc' -StartupType Disabled -ErrorAction Continue;
Set-Service -Name 'AudioEndpointBuilder' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'AudioSrv' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'Audiosrv' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'AxInstSV' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'BDESVC' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'BFE' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'BITS' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'BTAGService' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'BcastDVRUserService_*' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'BrokerInfrastructure' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'Browser' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'BthAvctpSvc' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'BthHFSrv' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'CDPSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'CDPUserSvc_*' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'COMSysApp' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'CaptureService_*' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'CertPropSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'ClipSVC' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'ConsentUxUserSvc_*' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'CoreMessagingRegistrar' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'CredentialEnrollmentManagerUserSvc_*' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'CryptSvc' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'CscService' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'DPS' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'DcomLaunch' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'DcpSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'DevQueryBroker' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'DeviceAssociationBrokerSvc_*' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'DeviceAssociationService' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'DeviceInstall' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'DevicePickerUserSvc_*' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'DevicesFlowUserSvc_*' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'Dhcp' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'DiagTrack' -StartupType Disabled -ErrorAction Continue;
Set-Service -Name 'DialogBlockingService' -StartupType Disabled -ErrorAction Continue;
Set-Service -Name 'DispBrokerDesktopSvc' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'DisplayEnhancementService' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'DmEnrollmentSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'Dnscache' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'DoSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'DsSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'DsmSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'DusmSvc' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'EFS' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'EapHost' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'EntAppSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'EventLog' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'EventSystem' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'FDResPub' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'Fax' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'FontCache' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'FrameServer' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'FrameServerMonitor' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'GraphicsPerfSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'HomeGroupListener' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'HomeGroupProvider' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'HvHost' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'IEEtwCollectorService' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'IKEEXT' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'InstallService' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'InventorySvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'IpxlatCfgSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'KeyIso' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'KtmRm' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'LSM' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'LanmanServer' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'LanmanWorkstation' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'LicenseManager' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'LxpSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'MSDTC' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'MSiSCSI' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'MapsBroker' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'McpManagementService' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'MessagingService_*' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'MicrosoftEdgeElevationService' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'MixedRealityOpenXRSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'MpsSvc' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'MsKeyboardFilter' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'NPSMSvc_*' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'NaturalAuthentication' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'NcaSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'NcbService' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'NcdAutoSetup' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'NetSetupSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'NetTcpPortSharing' -StartupType Disabled -ErrorAction Continue;
Set-Service -Name 'Netlogon' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'Netman' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'NgcCtnrSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'NgcSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'NlaSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'OneSyncSvc_*' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'P9RdrService_*' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'PNRPAutoReg' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'PNRPsvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'PcaSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'PeerDistSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'PenService_*' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'PerfHost' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'PhoneSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'PimIndexMaintenanceSvc_*' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'PlugPlay' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'PolicyAgent' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'Power' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'PrintNotify' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'PrintWorkflowUserSvc_*' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'ProfSvc' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'PushToInstall' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'QWAVE' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'RasAuto' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'RasMan' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'RemoteAccess' -StartupType Disabled -ErrorAction Continue;
Set-Service -Name 'RemoteRegistry' -StartupType Disabled -ErrorAction Continue;
Set-Service -Name 'RetailDemo' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'RmSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'RpcEptMapper' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'RpcLocator' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'RpcSs' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'SCPolicySvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'SCardSvr' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'SDRSVC' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'SEMgrSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'SENS' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'SNMPTRAP' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'SNMPTrap' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'SSDPSRV' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'SamSs' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'ScDeviceEnum' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'Schedule' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'SecurityHealthService' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'Sense' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'SensorDataService' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'SensorService' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'SensrSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'SessionEnv' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'SgrmBroker' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'SharedAccess' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'SharedRealitySvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'ShellHWDetection' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'SmsRouter' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'Spooler' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'SstpSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'StateRepository' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'StiSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'StorSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'SysMain' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'SystemEventsBroker' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'TabletInputService' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'TapiSrv' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'TermService' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'TextInputManagementService' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'Themes' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'TieringEngineService' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'TimeBroker' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'TimeBrokerSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'TokenBroker' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'TrkWks' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'TroubleshootingSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'TrustedInstaller' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'UI0Detect' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'UdkUserSvc_*' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'UevAgentService' -StartupType Disabled -ErrorAction Continue;
Set-Service -Name 'UmRdpService' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'UnistoreSvc_*' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'UserDataSvc_*' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'UserManager' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'UsoSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'VGAuthService' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'VMTools' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'VSS' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'VacSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'VaultSvc' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'W32Time' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'WEPHOSTSVC' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'WFDSConMgrSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'WMPNetworkSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'WManSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'WPDBusEnum' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'WSService' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'WSearch' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'WaaSMedicSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'WalletService' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'WarpJITSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'WbioSrvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'Wcmsvc' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'WcsPlugInService' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'WdNisSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'WdiServiceHost' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'WdiSystemHost' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'WebClient' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'Wecsvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'WerSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'WiaRpc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'WinDefend' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'WinHttpAutoProxySvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'WinRM' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'Winmgmt' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'WlanSvc' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'WpcMonSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'WpnService' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'WpnUserService_*' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'WwanSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'XblAuthManager' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'XblGameSave' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'XboxGipSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'XboxNetApiSvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'autotimesvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'bthserv' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'camsvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'cbdhsvc_*' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'cloudidsvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'dcsvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'defragsvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'diagnosticshub.standardcollector.service' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'diagsvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'dmwappushservice' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'dot3svc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'edgeupdate' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'edgeupdatem' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'embeddedmode' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'fdPHost' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'fhsvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'gpsvc' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'hidserv' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'icssvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'iphlpsvc' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'lfsvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'lltdsvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'lmhosts' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'mpssvc' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'msiserver' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'netprofm' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'nsi' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'p2pimsvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'p2psvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'perceptionsimulation' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'pla' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'seclogon' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'shpamsvc' -StartupType Disabled -ErrorAction Continue;
Set-Service -Name 'smphost' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'spectrum' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'sppsvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'ssh-agent' -StartupType Disabled -ErrorAction Continue;
Set-Service -Name 'svsvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'swprv' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'tiledatamodelsvc' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'tzautoupdate' -StartupType Disabled -ErrorAction Continue;
Set-Service -Name 'uhssvc' -StartupType Disabled -ErrorAction Continue;
Set-Service -Name 'upnphost' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'vds' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'vm3dservice' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'vmicguestinterface' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'vmicheartbeat' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'vmickvpexchange' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'vmicrdv' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'vmicshutdown' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'vmictimesync' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'vmicvmsession' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'vmicvss' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'vmvss' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'wbengine' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'wcncsvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'webthreatdefsvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'webthreatdefusersvc_*' -StartupType Automatic -ErrorAction Continue;
Set-Service -Name 'wercplsupport' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'wisvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'wlidsvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'wlpasvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'wmiApSrv' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'workfolderssvc' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'wuauserv' -StartupType Manual -ErrorAction Continue;
Set-Service -Name 'wudfsvc' -StartupType Manual -ErrorAction Continue;
    </File>
    <File path="C:\Windows\Setup\Scripts\local-machine.cmd">
:: Prevents Chat Auto Installation and Removes Chat Icon
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Chat" /v "ChatIcon" /t REG_DWORD /d 3 /f

:: Disables Bitlocker Auto Encryption on Windows 11 24H2 and Onwards
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\EnhancedStorageDevices" /v TCGSecurityActivationDisabled /t REG_DWORD /d 1 /f

:: Disables Cortana
reg.exe add "HKLM\Software\Policies\Microsoft\Windows\Windows Search" /v AllowCortana /t REG_DWORD /d 0 /f

:: Disables Activity History
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\System" /v EnableActivityFeed /t REG_DWORD /d 0 /f
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\System" /v PublishUserActivities /t REG_DWORD /d 0 /f
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\System" /v UploadUserActivities /t REG_DWORD /d 0 /f

:: Disables Location Tracking
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\location" /v Value /t REG_SZ /d Deny /f
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Sensor\Overrides\{BFA794E4-F964-4FDB-90F6-51056BFE4B44}" /v SensorPermissionState /t REG_DWORD /d 0 /f
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\lfsvc\Service\Configuration" /v Status /t REG_DWORD /d 0 /f
reg.exe add "HKLM\SYSTEM\Maps" /v AutoUpdateEnabled /t REG_DWORD /d 0 /f

:: Disables Telemetry
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\DataCollection" /v AllowTelemetry /t REG_DWORD /d 0 /f
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection" /v AllowTelemetry /t REG_DWORD /d 0 /f

:: Disables Windows Ink Workspace
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\WindowsInkWorkspace" /v AllowWindowsInkWorkspace /t REG_DWORD /d 0 /f

:: Disables Feedback Notifications
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection" /v DoNotShowFeedbackNotifications /t REG_DWORD /d 1 /f

:: Disables the Advertising ID for All Users
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AdvertisingInfo" /v DisabledByGroupPolicy /t REG_DWORD /d 1 /f

:: Disables Windows Error Reporting
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\Windows Error Reporting" /v Disabled /t REG_DWORD /d 1 /f

:: Disables Delivery Optimization
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization\Config" /v DODownloadMode /t REG_DWORD /d 0 /f

:: Disables Remote Assistance
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\Remote Assistance" /v fAllowToGetHelp /t REG_DWORD /d 0 /f

:: Search Windows Update for Drivers First
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DriverSearching" /v SearchOrderConfig /t REG_DWORD /d 1 /f

:: Gives Multimedia Applications like Games and Video Editing a Higher Priority
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile" /v SystemResponsiveness /t REG_DWORD /d 0 /f
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile" /v NetworkThrottlingIndex /t REG_DWORD /d 10 /f

:: Controls whether the memory page file is cleared at shutdown. Value 0 means it will not be cleared, speeding up shutdown.
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management" /v ClearPageFileAtShutdown /t REG_DWORD /d 0 /f

:: Enables NDU (Network Diagnostic Usage) Service on Startup
reg.exe add "HKLM\SYSTEM\ControlSet001\Services\Ndu" /v Start /t REG_DWORD /d 2 /f

:: Increases IRP stack size to 30 for the LanmanServer service to Improve Network Performance and Stability
reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters" /v IRPStackSize /t REG_DWORD /d 30 /f

:: Hides the Meet Now Button on the Taskbar
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v HideSCAMeetNow /t REG_DWORD /d 1 /f

:: Gives Graphics Cards a Higher Priority for Gaming
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" /v "GPU Priority" /t REG_DWORD /d 8 /f

:: Gives the CPU a Higher Priority for Gaming
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" /v Priority /t REG_DWORD /d 6 /f

:: Gives Games a higher priority in the system's scheduling
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Multimedia\SystemProfile\Tasks\Games" /v "Scheduling Category" /t REG_SZ /d "High" /f

:: Fix Managed by your organization in Edge
reg.exe delete "HKLM\SOFTWARE\Policies\Microsoft\Edge" /f

:: Set Registry Keys to Disable Wifi-Sense
reg.exe add "HKLM\Software\Microsoft\PolicyManager\default\WiFi\AllowWiFiHotSpotReporting" /v Value /t REG_DWORD /d 0 /f
reg.exe add "HKLM\Software\Microsoft\PolicyManager\default\WiFi\AllowAutoConnectToWiFiSenseHotspots" /v Value /t REG_DWORD /d 0 /f

:: Disables Storage Sense
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\StorageSense\Parameters\StoragePolicy" /v 01 /t REG_DWORD /d 0 /f

:: Disable Xbox GameDVR
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\GameDVR" /v AllowGameDVR /t REG_DWORD /d 0 /f

:: Disable "Use my sign-in info to automatically finish setting up my device after an update or restart"
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v DisableAutomaticRestartSignOn /t REG_DWORD /d 1 /f

:: Enable Status Messages
reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v DisableStatusMessages /t REG_DWORD /d 0 /f

:: Disables OneDrive Automatic Backups of Important Folders (Documents, Pictures etc.)
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\OneDrive" /v KFMBlockOptIn /t REG_DWORD /d 1 /f

:: Disables the "Push To Install" feature in Windows
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\PushToInstall" /v "DisablePushToInstall" /t REG_DWORD /d 1 /f

:: Disables Consumer Account State Content
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v "DisableConsumerAccountStateContent" /t REG_DWORD /d 1 /f

:: Disables Cloud Optimized Content
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v "DisableCloudOptimizedContent" /t REG_DWORD /d 1 /f

:: Deleting Application Compatibility Appraiser
reg.exe delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{0600DD45-FAF2-4131-A006-0B17509B9F78}" /f

:: Deleting Customer Experience Improvement Program
reg.exe delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{4738DE7A-BCC1-4E2D-B1B0-CADB044BFA81}" /f
reg.exe delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{6FAC31FA-4A85-4E64-BFD5-2154FF4594B3}" /f
reg.exe delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{FC931F16-B50A-472E-B061-B6F79A71EF59}" /f

:: Deleting Program Data Updater
reg.exe delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{0671EB05-7D95-4153-A32B-1426B9FE61DB}" /f

:: Deleting autochk proxy
reg.exe delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{87BF85F4-2CE1-4160-96EA-52F554AA28A2}" /f
reg.exe delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{8A9C643C-3D74-4099-B6BD-9C6D170898B1}" /f

:: Deleting QueueReporting
reg.exe delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\{E3176A65-4E44-4ED3-AA73-3283660ACB9C}" /f
    </File>
    <File path="C:\Windows\Setup\Scripts\Specialize.ps1" transformation="Text">
$scripts = @(
  {
    reg.exe add "HKLM\SYSTEM\Setup\MoSetup" /v AllowUpgradesWithUnsupportedTPMOrCPU /t REG_DWORD /d 1 /f;
  };
  {
    reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\OOBE" /v BypassNRO /t REG_DWORD /d 1 /f;
  };
  {
    Remove-Item -LiteralPath 'Registry::HKLM\Software\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\DevHomeUpdate' -Force -ErrorAction 'SilentlyContinue';
  };
  {
    Remove-Item -LiteralPath 'C:\Users\Default\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\OneDrive.lnk', 'C:\Users\Default\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\OneDrive.exe', 'C:\Windows\System32\OneDriveSetup.exe', 'C:\Windows\SysWOW64\OneDriveSetup.exe' -ErrorAction 'Continue';
  };
  {
    Remove-Item -LiteralPath 'Registry::HKLM\Software\Microsoft\WindowsUpdate\Orchestrator\UScheduler_Oobe\OutlookUpdate' -Force -ErrorAction 'SilentlyContinue';
  };
  {
    reg.exe add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Communications" /v ConfigureChatAutoInstall /t REG_DWORD /d 0 /f;
  };
  {
    Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\RemovePackages.ps1' -Raw | Invoke-Expression;
  };
  {
    Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\RemoveCapabilities.ps1' -Raw | Invoke-Expression;
  };
  {
    Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\RemoveFeatures.ps1' -Raw | Invoke-Expression;
  };
  {
    net.exe accounts /maxpwage:UNLIMITED;
  };
  {
    reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\FileSystem" /v LongPathsEnabled /t REG_DWORD /d 1 /f
  };
  {
    icacls.exe C:\ /remove:g "*S-1-5-11"
  };
  {
    Set-ExecutionPolicy -Scope 'LocalMachine' -ExecutionPolicy 'RemoteSigned' -Force;
  };
  {
    fsutil.exe behavior set disableLastAccess 1;
  };
  {
    reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Power" /v HiberbootEnabled /t REG_DWORD /d 0 /f;
  };
  {
    reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Dsh" /v AllowNewsAndInterests /t REG_DWORD /d 0 /f;
  };
  {
    reg.exe add "HKLM\Software\Policies\Microsoft\Windows\CloudContent" /v "DisableWindowsConsumerFeatures" /t REG_DWORD /d 0 /f;
  };
  {
    reg.exe add "HKLM\SYSTEM\CurrentControlSet\Control\BitLocker" /v "PreventDeviceEncryption" /t REG_DWORD /d 1 /f;
  };
  {
    reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Edge" /v HideFirstRunExperience /t REG_DWORD /d 1 /f;
  };
  {
    Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\SetStartPins.ps1' -Raw | Invoke-Expression;
  };
  {
    Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\WinTweaks.ps1' -Raw | Invoke-Expression;
  };
  {
    reg.exe import "C:\Windows\Setup\Scripts\TakeOwnership.reg";
  };
  {
    C:\Windows\Setup\Scripts\local-machine.cmd;
  }
);

&amp; {
  [float]$complete = 0;
  [float]$increment = 100 / $scripts.Count;
  foreach ($script in $scripts) {
    Write-Progress -Activity 'Specialize.ps1' -PercentComplete $complete;
    &amp; $script;
    $complete += $increment;
  }
} *&gt;&amp;1 &gt;&gt; "C:\Windows\Setup\Scripts\Specialize.log";
    </File>
    <File path="C:\Windows\Setup\Scripts\TaskbarIcons.ps1" transformation="Text">
Remove-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Taskband' -Name '*';
    </File>
    <File path="C:\Windows\Setup\Scripts\UserOnce.ps1" transformation="Text">
$scripts = @(
  {
    Get-AppxPackage -Name 'Microsoft.Windows.Ai.Copilot.Provider' | Remove-AppxPackage;
  };
  {
    Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\TaskbarIcons.ps1' -Raw | Invoke-Expression;
  };
  {
    $params = @{
      Path = 'Registry::HKCU\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32';
      ErrorAction = 'SilentlyContinue';
      Force = $true;
    };
    New-Item @params;
    Set-ItemProperty @params -Name '(Default)' -Value '' -Type 'String';
  };
  {
    Set-ItemProperty -LiteralPath 'Registry::HKCU\Software\Microsoft\Windows\CurrentVersion\Search' -Name 'SearchboxTaskbarMode' -Type 'DWord' -Value 0;
  };
  {
    Get-Process -Name 'explorer' -ErrorAction 'SilentlyContinue' | Where-Object -FilterScript {
      $_.SessionId -eq ( Get-Process -Id $PID ).SessionId;
    } | Stop-Process -Force;
  };
);

&amp; {
  [float]$complete = 0;
  [float]$increment = 100 / $scripts.Count;
  foreach ($script in $scripts) {
    Write-Progress -Activity 'UserOnce.ps1' -PercentComplete $complete;
    &amp; $script;
    $complete += $increment;
  }
} *&gt;&amp;1 &gt;&gt; "$env:TEMP\UserOnce.log";
    </File>
    <File path="C:\Windows\Setup\Scripts\default-user.cmd">
:: Disabling the Delivery of Personalized or Suggested Content Like App Suggestions, Tips, and Advertisements in Windows
reg.exe delete "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager\Subscriptions" /f
reg.exe delete "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\ContentDeliveryManager\SuggestedApps" /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Speech_OneCore\Settings\OnlineSpeechPrivacy" /v "HasAccepted" /t REG_DWORD /d 0 /f

:: Removes Copilot
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Runonce" /v "UninstallCopilot" /t REG_SZ /d "" /f

:: Disables Recently Added Apps and Recommendations in the Start Menu
reg.exe add "HKU\DefaultUser\Software\Policies\Microsoft\Windows\Explorer" /v HideRecentlyAddedApps /t REG_DWORD /d 1 /f
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v Start_IrisRecommendations /t REG_DWORD /d 0 /f

:: Hides or Removes People from Taskbar
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced\People" /v PeopleBand /t REG_DWORD /d 0 /f

:: Hides and Removes News and Interests from PC and Taskbar
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Feeds" /v ShellFeedsTaskbarViewMode /t REG_DWORD /d 2 /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Feeds" /v ShellFeedsEnabled /t REG_DWORD /d 0 /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Policies\Microsoft\Windows\Windows Feeds" /v EnableFeeds /t REG_DWORD /d 0 /f

:: Disables Input Personalization Settings
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Personalization\Settings" /v AcceptedPrivacyPolicy /t REG_DWORD /d 0 /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\InputPersonalization" /v RestrictImplicitTextCollection /t REG_DWORD /d 1 /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\InputPersonalization" /v RestrictImplicitInkCollection /t REG_DWORD /d 1 /f

:: Disables Telemetry and Ads
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Siuf\Rules" /v NumberOfSIUFInPeriod /t REG_DWORD /d 0 /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableTailoredExperiencesWithDiagnosticData /t REG_DWORD /d 1 /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v ShowSyncProviderNotifications /t REG_DWORD /d 0 /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\AdvertisingInfo" /v Enabled /t REG_DWORD /d 0 /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\InputPersonalization\TrainedDataStore" /v "HarvestContacts" /t REG_DWORD /d 0 /f

:: Manages and displays the status of ongoing operations, such as file copy, move, delete, etc.
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\OperationStatusManager" /v EnthusiastMode /t REG_DWORD /d 1 /f

:: On Shutdown, Windows will automatically close any running applications
reg.exe add "HKU\DefaultUser\Control Panel\Desktop" /v AutoEndTasks /t REG_DWORD /d 1 /f

:: Sets the Mouse hover time to 400 milliseconds
reg.exe add "HKU\DefaultUser\Control Panel\Mouse" /v MouseHoverTime /t REG_SZ /d "400" /f

:: Hides the Meet Now Button on the Taskbar
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v HideSCAMeetNow /t REG_DWORD /d 1 /f

:: Disables the Second Out-Of-Box Experience
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\UserProfileEngagement" /v ScoobeSystemSettingEnabled /t REG_DWORD /d 0 /f

:: Set Display for Performance
reg.exe add "HKU\DefaultUser\Control Panel\Desktop" /v DragFullWindows /t REG_SZ /d 1 /f
reg.exe add "HKU\DefaultUser\Control Panel\Desktop" /v MenuShowDelay /t REG_SZ /d 200 /f
reg.exe add "HKU\DefaultUser\Control Panel\Desktop\WindowMetrics" /v MinAnimate /t REG_SZ /d 0 /f
reg.exe add "HKU\DefaultUser\Control Panel\Keyboard" /v KeyboardDelay /t REG_DWORD /d 0 /f
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v ListviewAlphaSelect /t REG_DWORD /d 1 /f
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v ListviewShadow /t REG_DWORD /d 0 /f
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v TaskbarAnimations /t REG_DWORD /d 0 /f
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v TaskbarMn /t REG_DWORD /d 0 /f
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v TaskbarDa /t REG_DWORD /d 0 /f
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects" /v VisualFXSetting /t REG_DWORD /d 3 /f
reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\DWM" /v EnableAeroPeek /t REG_DWORD /d 0 /f

:: Set Registry Keys to Enable End Task With Right Click
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v TaskbarDeveloperSettings /t REG_DWORD /d 1 /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v TaskbarEndTask /t REG_DWORD /d 1 /f

:: Disable Xbox GameDVR
reg.exe add "HKU\DefaultUser\System\GameConfigStore" /v GameDVR_FSEBehavior /t REG_DWORD /d 2 /f
reg.exe add "HKU\DefaultUser\System\GameConfigStore" /v GameDVR_Enabled /t REG_DWORD /d 0 /f
reg.exe add "HKU\DefaultUser\System\GameConfigStore" /v GameDVR_DXGIHonorFSEWindowsCompatible /t REG_DWORD /d 1 /f
reg.exe add "HKU\DefaultUser\System\GameConfigStore" /v GameDVR_HonorUserFSEBehaviorMode /t REG_DWORD /d 1 /f
reg.exe add "HKU\DefaultUser\System\GameConfigStore" /v GameDVR_EFSEFeatureFlags /t REG_DWORD /d 0 /f

:: Enables Underline Access Keys
reg.exe add "HKU\DefaultUser\Control Panel\Accessibility\Keyboard Preference" /v On /t REG_SZ /d "1" /f

:: Disables Sticky Keys
reg.exe add "HKU\DefaultUser\Control Panel\Accessibility\StickyKeys" /v Flags /t REG_SZ /d "506" /f
reg.exe add "HKU\DefaultUser\Control Panel\Accessibility\StickyKeys" /v HotkeyFlags /t REG_SZ /d "58" /f

:: Restore Windows Photo Viewer
reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.bmp" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.cr2" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.dib" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.gif" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.ico" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.jfif" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.jpe" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.jpeg" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.jpg" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.jxr" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.png" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.tif" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.tiff" /ve /d "PhotoViewer.FileAssoc.Tiff" /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Classes\.wdp" /ve /d "PhotoViewer.FileAssoc.Tiff" /f

:: Create Relevant File Associations
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.bmp\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.cr2\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.dib\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.gif\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ico\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.jfif\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.jpe\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.jpeg\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.jpg\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.jxr\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.png\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.tif\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.tiff\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f
reg.exe add "HKU\DefaultUser\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.wdp\OpenWithProgids" /v "PhotoViewer.FileAssoc.Tiff" /t REG_NONE /f

:: Disables Windows Recall on Copilot+ PC
reg.exe add "HKU\DefaultUser\Software\Policies\Microsoft\Windows\WindowsAI" /f
reg.exe add "HKU\DefaultUser\Software\Policies\Microsoft\Windows\WindowsAI" /v "DisableAIDataAnalysis" /t REG_DWORD /d 1 /f
reg.exe add "HKU\DefaultUser\Software\Policies\Microsoft\Windows\Windows AI" /v "TurnOffSavingSnapshots" /t REG_DWORD /d 1 /f

:: Disables Wallpaper JPEG Quality Reduction in Windows 10
reg.exe add "HKU\DefaultUser\Control Panel\Desktop" /v "JPEGImportQuality" /t REG_DWORD /d 100 /f
    </File>
    <File path="C:\Windows\Setup\Scripts\DefaultUser.ps1" transformation="Text">
$scripts = @(
  {
    reg.exe add "HKU\DefaultUser\Software\Policies\Microsoft\Windows\WindowsCopilot" /v TurnOffWindowsCopilot /t REG_DWORD /d 1 /f;
  };
  {
    reg.exe add "HKU\DefaultUser\Software\Microsoft\Notepad" /v ShowStoreBanner /t REG_DWORD /d 0 /f;
  };
  {
    Remove-ItemProperty -LiteralPath 'Registry::HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Run' -Name 'OneDriveSetup' -Force -ErrorAction 'Continue';
  };
  {
    reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "HideFileExt" /t REG_DWORD /d 0 /f;
  };
  {
    reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v ShowTaskViewButton /t REG_DWORD /d 0 /f;
  };
  {
    $names = @(
      'ContentDeliveryAllowed';
      'FeatureManagementEnabled';
      'OEMPreInstalledAppsEnabled';
      'PreInstalledAppsEnabled';
      'PreInstalledAppsEverEnabled';
      'RotatingLockScreenOverlayEnabled';
      'SilentInstalledAppsEnabled';
      'SoftLandingEnabled';
      'SubscribedContentEnabled';
      'SubscribedContent-310093Enabled';
      'SubscribedContent-338387Enabled';
      'SubscribedContent-338388Enabled';
      'SubscribedContent-338389Enabled';
      'SubscribedContent-338393Enabled';
      'SubscribedContent-353694Enabled';
      'SubscribedContent-353696Enabled';
      'SubscribedContent-353698Enabled';
      'SystemPaneSuggestionsEnabled';
      'TailoredExperiencesWithDiagnosticDataEnabled';
    );

    foreach ($name in $names) {
      reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\ContentDeliveryManager" /v $name /t REG_DWORD /d 0 /f;
    }
  };
  {
    reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v TaskbarAl /t REG_DWORD /d 0 /f;
  };
  {
    foreach ($root in 'Registry::HKU\.DEFAULT', 'Registry::HKU\DefaultUser') {
      Set-ItemProperty -LiteralPath "$root\Control Panel\Keyboard" -Name 'InitialKeyboardIndicators' -Type 'String' -Value 2 -Force;
    }
  };
  {
    $params = @{
      LiteralPath = 'Registry::HKU\DefaultUser\Control Panel\Mouse';
      Type = 'String';
      Value = 0;
      Force = $true;
    };
    Set-ItemProperty @params -Name 'MouseSpeed';
    Set-ItemProperty @params -Name 'MouseThreshold1';
    Set-ItemProperty @params -Name 'MouseThreshold2';
  };
  {
    reg.exe add "HKU\DefaultUser\Software\Policies\Microsoft\Windows\Explorer" /v DisableSearchBoxSuggestions /t REG_DWORD /d 1 /f;
  };
  {
    C:\Windows\Setup\Scripts\default-user.cmd;
  };
  {
    reg.exe add "HKU\DefaultUser\Software\Microsoft\Windows\CurrentVersion\RunOnce" /v "UnattendedSetup" /t REG_SZ /d "powershell.exe -NoProfile -Command \""Get-Content -LiteralPath 'C:\Windows\Setup\Scripts\UserOnce.ps1' -Raw | Invoke-Expression;\""" /f;
  };
);

&amp; {
  [float]$complete = 0;
  [float]$increment = 100 / $scripts.Count;
  foreach ($script in $scripts) {
    Write-Progress -Activity 'DefaultUser.ps1' -PercentComplete $complete;
    &amp; $script;
    $complete += $increment;
  }
} *&gt;&amp;1 &gt;&gt; "C:\Windows\Setup\Scripts\DefaultUser.log";
    </File>
    <File path="C:\Windows\Setup\Scripts\FirstLogon.ps1" transformation="Text">
$scripts = @(
  {
    cmd.exe /c "rmdir C:\Windows.old";
  };
);

&amp; {
  [float]$complete = 0;
  [float]$increment = 100 / $scripts.Count;
  foreach ($script in $scripts) {
    Write-Progress -Activity 'FirstLogon.ps1' -PercentComplete $complete;
    &amp; $script;
    $complete += $increment;
  }
} *&gt;&amp;1 &gt;&gt; "C:\Windows\Setup\Scripts\FirstLogon.log";
    </File>
    <File path="C:\Users\Default\AppData\Local\Microsoft\Windows\Shell\LayoutModification.xml" transformation="Text">
&lt;LayoutModificationTemplate Version="1" xmlns="http://schemas.microsoft.com/Start/2014/LayoutModification"&gt;
  &lt;LayoutOptions StartTileGroupCellWidth="6" /&gt;
  &lt;DefaultLayoutOverride&gt;
    &lt;StartLayoutCollection&gt;
      &lt;StartLayout GroupCellWidth="6" xmlns="http://schemas.microsoft.com/Start/2014/FullDefaultLayout" /&gt;
    &lt;/StartLayoutCollection&gt;
  &lt;/DefaultLayoutOverride&gt;
&lt;/LayoutModificationTemplate&gt;
    </File>
  </Extensions>
</unattend>
